var SP={};SP.jQuery=jq182,SP.logEvent=function(data){"undefined"!=typeof SP.EventLogger&&SP.EventLogger.log(data)},SP.jQuery(document).ready(function($){if($(window).resize(function(){SP.Breakpoint.applyBodyClass()}),SP.Breakpoint.init(),$("#learn-accordion").length){new SP.LearnAccordion("#learn-accordion","#learn-accordion-mobile")}SP.Topic.init(),SP.TopicHeader.init(),SP.EventLogger.init(),SP.Menu.init(),SP.ProposalPhaseTabs.init(),SP.InterestSurvey.init(),SP.Carousel.init(),$(".truncate").each(function(){var max=$(this).closest("[data-truncate-limit]").data("truncate-limit");max&&$(this).truncate({max_length:max})}),$("abbr.glossary").tooltip({container:"body"}),$("ul.nice-menu-down li.menuparent a").mouseenter(function(){var $link=$(this),widthParentLink=$link.width(),$subMenu=$link.next(),widthSubmenu=$subMenu.width(),newWidthSubmenu=widthSubmenu>=widthParentLink?200:widthParentLink;$subMenu.width(newWidthSubmenu+"px")})});
!function(Self,$){Self.breakpoints={lgDevice:{className:"lg-device",minWidth:1200},mdDevice:{className:"md-device",minWidth:979},smDevice:{className:"sm-device",minWidth:767},xsDevice:{className:"xs-device",minWidth:480},xxsDevice:{className:"xxs-device",minWidth:320}},Self._activeBreakpoint="",Self.init=function(){Self.applyBodyClass()},Self.applyBodyClass=function(){var classToAdd,breakpoints=Self.breakpoints,mq=function(minWidth){return Modernizr.mq("only screen and (min-width: "+minWidth+"px)")},$body=$("body");$.each(breakpoints,function(i,v){return mq(v.minWidth)?(classToAdd=v.className,Self.setActiveBreakpoint(i),!1):void 0}),void 0===classToAdd||$body.hasClass(classToAdd)||($.each(breakpoints,function(i,v){$body.removeClass(v.className)}),$body.addClass(classToAdd))},Self.isDesktop=function(){switch(this.getActiveBreakpoint()){case"lgDevice":case"mdDevice":return!0;default:return!1}},Self.isTablet=function(){return"smDevice"==this.getActiveBreakpoint()?!0:!1},Self.isPhone=function(){switch(this.getActiveBreakpoint()){case"xsDevice":case"xxsDevice":return!0;default:return!1}},Self.getActiveBreakpoint=function(){return this._activeBreakpoint},Self.setActiveBreakpoint=function(breakpointKey){this._activeBreakpoint=breakpointKey}}(SP.Breakpoint={},SP.jQuery);
!function(){var initializing=!1,superPattern=/xyz/.test(function(){})?/\b_super\b/:/.*/;Object.subClass=function(properties){function Class(){!initializing&&this.init&&this.init.apply(this,arguments)}var _super=this.prototype;initializing=!0;var proto=new this;initializing=!1;for(var name in properties)proto[name]="function"==typeof properties[name]&&"function"==typeof _super[name]&&superPattern.test(properties[name])?function(name,fn){return function(){var tmp=this._super;this._super=_super[name];var ret=fn.apply(this,arguments);return this._super=tmp,ret}}(name,properties[name]):properties[name];return Class.prototype=proto,Class.constructor=Class,Class.subClass=arguments.callee,Class}}();
!function(Self,$){function appendAlert(id,message,type,allowClose){var settings=Drupal.settings.rrAlert,$template=$(settings.template),$closeButton=$template.find(".close").clone();allowClose="undefined"!=typeof allowClose?allowClose:!0,$template.attr("id",id),$template.find(".message").html(message),allowClose&&$template.find(".message").prepend($closeButton),$template.appendTo("body"),$("#"+id).find("button.close").click(function(){if(Self.close($(this)),void 0!==type&&type)switch(type){case"comment-tips-button":SP.logEvent({name:"close comment tips"});break;case"comment-tips-alert":SP.logEvent({name:"close comment tips prompt"})}})}Self.open=function(id,message,type,allowClose){var $openAlert=$(".alert:not(:hidden)"),$alert=$("#"+id);if($alert.length||(appendAlert(id,message,type,allowClose),$alert=$("#"+id)),$openAlert.length?$openAlert.slideUp("fast",function(){$(this).is("#"+id)||$(this).remove(),$("#"+id).slideDown("slow")}):$("#"+id).slideDown("slow"),void 0!==type&&type)switch(type){case"interest-survey":SP.InterestSurvey.attachDialogClickHandler($("#"+id));break;case"login":$openAlert.length||SP.Login.attachDialogClickHandlers($("#"+id));break;case"comment-tips-prompt":$openAlert.length||SP.Topic.Comment.CommentTips.attachAlertActionHandlers($alert)}},Self.close=function($button){$button.closest(".alert").remove()}}(SP.Alert={},SP.jQuery);
!function(Self,$){Self.init=function(){$(".rs-carousel").carousel({itemsPerTransition:"auto",touch:Modernizr&&Modernizr.touch,pagination:!1,insertPrevAction:function(){return $('<a href="#" class="rs-carousel-action-prev"></a>').appendTo($(this).closest(".carousel-container").find(".carousel-prev"))},insertNextAction:function(){return $('<a href="#" class="rs-carousel-action-next"></a>').appendTo($(this).closest(".carousel-container").find(".carousel-next"))}}).show(400,function(){var $rsCarousel=$(this);$rsCarousel.closest(".carousel-container").find(".paging-link").show(),$rsCarousel.carousel("refresh"),refreshArrowState($rsCarousel)}),$(".carousel-prompt").click(function(){$(this).next(".proposal-topics").fadeOut("slow").fadeIn("slow")}),$(window).resize(function(){$(".rs-carousel").carousel("refresh"),$(".rs-carousel").each(function(){var $carousel=$(this);refreshArrowState($carousel)})});var refreshArrowState=function($carousel){var noOfPages=$carousel.carousel("getNoOfPages");1===noOfPages?$carousel.closest(".carousel-container").find(".paging-link").hide():$carousel.closest(".carousel-container").find(".paging-link").show()}}}(SP.Carousel={},SP.jQuery);
!function(Self,$){$.fn.rrDialog=function(options){function updateWidth(width){return SP.Breakpoint.breakpoints[SP.Breakpoint.getActiveBreakpoint()].minWidth<=width?width="auto":"auto"==width&&(width=$dlg.data("originalWidth")),width}var $dlg=this;return options=$.extend({autoOpen:!0,width:500,height:"auto",draggable:!1,modal:!0,resizable:!1,autoResize:!0,close:function(){var $dlg=$(this),$form=$dlg.find("form");$form.length&&SP.Form.clearFormErrorsAndValues($form),SP.logEvent({name:"close dialog",detail:"dialog: "+$dlg.attr("id")}),SP.Topic.TopicState.deleteStoredState()},open:function(){void 0!==SP.Topic&&SP.Topic.TopicState.setStoredState(),SP.MobileMenu.isVisible()&&SP.MobileMenu.close()}},options),$(window).resize(function(){$dlg.dialog("option","width",updateWidth($dlg.data("originalWidth")))}),$dlg.data("originalWidth",options.width),options.width=updateWidth(options.width),$dlg.dialog(options)},Self.dialogOpen=function(){var $dialog=$(".ui-dialog");return $dialog.length?$dialog.is(":visible"):!1}}(SP.Dialog={},SP.jQuery);
!function(Self,$){Self.init=function(){$("[data-rr-event]").each(function(){var el=$(this),event=el.data("rr-event");el.on(event,null,function(){Self.logElementData($(this))})})},Self.logElementData=function(el){var element_data=el.data(),data={};$.each(element_data,function(index,value){var key=index.replace(/^rrEvent_?/,"");key&&(key=key.replace(/([A-Z])/g,"_$1"),key=key.toLowerCase(),data[key]=value)}),Self.log(data)},Self.log=function(data,async){data.path=window.location.pathname,$("body").data("instanceStart")&&(data.instance_start=$("body").data("instanceStart")),"undefined"==typeof async&&(async=!0),$.ajax({type:"POST",url:"/ajax/log_event",data:data,dataType:"json",async:async})}}(SP.EventLogger={},SP.jQuery);
SP.jQuery(document).ready(function($){if($("body").hasClass("page-faq")){var $block=$("#block-smartparticipation-core-submit-faq"),$button=$block.find("h2"),$form=$block.find("#smartparticipation-core-submit-faq-form"),$email=$block.find("#edit-email"),$question=$block.find("#edit-question");$(".faq-question a").click(function(){return $(this).find(".faq-question-icon").toggleClass("active"),$(this).parent().nextAll(".faq-answer").slideToggle("fast"),!1}),$button.click(function(){$(this).toggleClass("open"),$form.slideToggle("fast"),$(this).hasClass("open")||SP.Form.clearFormErrorsAndValues($form)}),($email.hasClass("error")||$question.hasClass("error"))&&($button.toggleClass("open"),$form.show())}});
!function(Self,$){Self.init=function(){$("form:not(.webform-client-form) .form-required").each(function(){$(this).closest(".form-item").prepend($("<abbr/>").addClass("required").append("<span>*</span>"))}),$(".form-type-textfield label, .form-type-password label, .form-type-textarea label, .form-type-emailfield label").not("#smartparticipation-core-profile-form .form-type-textarea label, #smartparticipation-core-profile-form .form-type-textfield label").inFieldLabels()},Self.clearFormErrorsAndValues=function($form){this.clearFormErrors($form),this.clearFormValues($form)},Self.clearFormErrors=function($form){$form.find(".error").removeClass("error"),$form.find(".field-error").remove()},Self.clearCommentErrorAndValue=function($form){this.clearFormErrors($form),this.clearCommentValue($form)},Self.clearCommentValue=function($form){var instanceKey=$form.find("textarea").attr("id");CKEDITOR.instances[instanceKey].setData("")},Self.clearFormValues=function($form){$form.find(':input:not([type="submit"],[type="hidden"],[type="checkbox"],[type="radio"])').val("").blur(),$form.find('input[type="checkbox"],input[type="radio"]').prop("checked",!1),$form.find(":password").each(function(){$('label[for="'+$(this).attr("id")+'"]').show()}),this.hideDependentComponents($form)},Self.hideDependentComponents=function(){$.each(Drupal.settings,function(key,info){return"webform_conditional_"==key.substring(0,20)?($.each(info.fields,function(triggerField_key,triggerField_info){$.each(triggerField_info.dependent_fields,function(){$("#"+this.css_id).hide()})}),void 0):void 0})}}(SP.Form={},SP.jQuery);
!function($){"$:nomunge";var jq_throttle;$.throttle=jq_throttle=function(delay,no_trailing,callback,debounce_mode){function wrapper(){function exec(){last_exec=+new Date,callback.apply(that,args)}function clear(){timeout_id=void 0}var that=this,elapsed=+new Date-last_exec,args=arguments;debounce_mode&&!timeout_id&&exec(),timeout_id&&clearTimeout(timeout_id),void 0===debounce_mode&&elapsed>delay?exec():no_trailing!==!0&&(timeout_id=setTimeout(debounce_mode?clear:exec,void 0===debounce_mode?delay-elapsed:delay))}var timeout_id,last_exec=0;return"boolean"!=typeof no_trailing&&(debounce_mode=callback,callback=no_trailing,no_trailing=void 0),$.guid&&(wrapper.guid=callback.guid=callback.guid||$.guid++),wrapper},$.debounce=function(delay,at_begin,callback){return void 0===callback?jq_throttle(delay,at_begin,!1):jq_throttle(delay,callback,at_begin!==!1)}}(SP.jQuery);
SP.LearnAccordion=Object.subClass({init:function(accordionSelector,mobileAccordionSelector){var $=SP.jQuery,$learnAccordion=$(accordionSelector),$slides=$learnAccordion.find("li.learn-item"),slideCount=$slides.length,learnVideo=".learn-video",$learnVideo=$learnAccordion.find(learnVideo),$learnAccordionMobile=$(mobileAccordionSelector),$learnVideoMobile=$learnAccordionMobile.find(learnVideo),desktopSettings={mdDevice:{accordion:{width:940,height:297},video:{width:528,height:297}},lgDevice:{accordion:{width:1170,height:369},video:{width:657,height:370}}},activeBreakpoint=SP.Breakpoint.getActiveBreakpoint();this.$=$,this.$learnAccordion=$learnAccordion,this.slideCount=slideCount,this.$learnVideo=$learnVideo,this.$learnAccordionMobile=$learnAccordionMobile,this.$learnVideoMobile=$learnVideoMobile,this.desktopSettings=desktopSettings,this.activeBreakpoint=activeBreakpoint,this.lastActiveBreakpoint=null,this.videoCreated=!1,this.mobileVideoCreated=!1;var _self=this;this.build(),$(window).resize(function(){_self.refresh()})},refresh:function(){this.activeBreakpoint=SP.Breakpoint.getActiveBreakpoint(),this.build()},build:function(){this.desktopSettings.hasOwnProperty(this.activeBreakpoint)?this.lastActiveBreakpoint!=this.activeBreakpoint&&(null!=this.lastActiveBreakpoint&&(this.$learnAccordion.liteAccordion("destroy"),this.resizeVideo()),this.createAccordion(),this.videoCreated||(this.createVideo(),this.videoCreated=!0),this.lastActiveBreakpoint=this.activeBreakpoint):this.mobileVideoCreated||(this.createMobileVideo(),this.mobileVideoCreated=!0)},resizeVideo:function(){var _self=this;this.$learnVideo.each(function(){var $div=_self.$(this),id=$div.attr("id");jwplayer(id).resize(_self.desktopSettings[_self.activeBreakpoint].video.width,_self.desktopSettings[_self.activeBreakpoint].video.height)})},createVideo:function(){var _self=this,learnVideoIds=this.$learnVideo.map(function(){return this.id});this.$learnVideo.each(function(){_self.setupVideo(_self.$(this),_self.desktopSettings[_self.activeBreakpoint].video.width,_self.desktopSettings[_self.activeBreakpoint].video.height)}),this.applyStopVideoOnNewSlide(this.$learnAccordion,"h2",learnVideoIds)},createMobileVideo:function(){var _self=this,learnVideoIds=this.$learnVideoMobile.map(function(){return this.id});this.$learnVideoMobile.each(function(){_self.setupVideo(_self.$(this),"100%",null,"16:9")}),this.applyStopVideoOnNewSlide(this.$learnAccordionMobile,"a.accordion-toggle",learnVideoIds)},setupVideo:function($learnVideo,width,height,aspectratio){var id=$learnVideo.attr("id"),options={file:$learnVideo.data("video"),image:$learnVideo.data("image"),primary:"flash"};options.width=width,void 0!==height&&height&&(options.height=height),void 0!==aspectratio&&aspectratio&&(options.aspectratio=aspectratio),jwplayer(id).setup(options).onPlay(function(){var nodeId=id.split("-").pop();SP.logEvent({name:"play video",entity_type:"node",entity_id:nodeId})})},createAccordion:function(){this.$learnAccordion.liteAccordion({containerHeight:this.desktopSettings[this.activeBreakpoint].accordion.height,containerWidth:this.desktopSettings[this.activeBreakpoint].accordion.width,firstSlide:this.slideCount}).show()},applyStopVideoOnNewSlide:function($accordion,slideSelector,learnVideoIds){var _self=this,$slides=$accordion.find(slideSelector);this.slideCount>1&&$slides.on("click",function(){_self.$.each(learnVideoIds,function(index,value){var jwPlayer=jwplayer(value);jwPlayer.stop()})})}});
!function(Self,$){function showLogin(){var $dlgLogin=$(dlgLogin);$dlgLogin.rrDialog({width:450}),setInterval(function(){$dlgLogin.find("input[type=text],input[type=password]").each(function(){$('label[for="'+$(this).attr("id")+'"]').is(":hidden")||""===$(this).val()||$('label[for="'+$(this).attr("id")+'"]').hide()})},200)}function showRegister(){var dlgWidth=600;$(".splash .login-form").length>0&&($(dlgRegister).find(".error").removeClass("error").addClass("register-error"),$(dlgRegister).find(".field-error").removeClass("field-error").addClass("register-field-error"),dlgWidth=450),$(".social-login").length>0||$("#dlgRegister form").css("width","527px").css("border-right","0px"),$(dlgRegister).rrDialog({width:dlgWidth})}function showPassword(){$(dlgPassword).rrDialog({width:450})}function attachDialogClickHandlers($container){var settings=Drupal.settings.rrLogin,$dlgLogin=$(dlgLogin),$dlgRegister=$(dlgRegister),$dlgPassword=$(dlgPassword);settings&&(void 0===$container&&($container=$("body")),$container.find("a[href*='"+settings.loginPath+"']").each(function(){$(this).click(function(){return showLogin(),!1})}),$container.find("a[href*='"+settings.registerPath+"']").each(function(){$(this).click(function(){$dlgPassword.dialog("instance")&&$dlgPassword.dialog("isOpen")&&$dlgPassword.dialog("close");var $privateRegister=$(".private-discussion",dlgRegister);return $privateRegister.length>0&&$privateRegister.removeClass("email-not-found").find(".register-field-error").remove(),showRegister(),!1})}),$container.find("a[href*='"+settings.passwordPath+"']").each(function(){$(this).click(function(){return $dlgRegister.dialog("instance")&&$dlgRegister.dialog("isOpen")&&$dlgRegister.dialog("close"),$dlgLogin.dialog("instance")&&$dlgLogin.dialog("isOpen")&&$dlgLogin.dialog("close"),showPassword(),!1})}))}var dlgLogin="#dlgLogin",dlgRegister="#dlgRegister",dlgPassword="#dlgPassword";Self.attachDialogClickHandlers=function($container){attachDialogClickHandlers($container)},Self.isLoggedIn=function(){return!$("body").hasClass("not-logged-in")},Drupal.behaviors.rrLogin={attach:function(){var settings=Drupal.settings.rrLogin,$formLogin=$("#user-login"),$formRegister=$("#user-register-form"),$formPassword=$("#user-pass"),hash=window.location.hash;SP.Breakpoint.applyBodyClass(),settings&&settings.destination&&($formLogin.attr("action",settings.destination),$formRegister.attr("action",settings.destination)),settings&&"user_login"==settings.submitted?$formLogin.find(".error").length&&(SP.Form.clearFormErrors($formRegister),SP.Form.clearFormErrors($formPassword),showLogin()):settings&&"user_register_form"==settings.submitted?$formRegister.find(".error").length&&(SP.Form.clearFormErrors($formLogin),SP.Form.clearFormErrors($formPassword),showRegister()):settings&&"user_pass"==settings.submitted?$formPassword.find(".error").length&&(SP.Form.clearFormErrors($formLogin),SP.Form.clearFormErrors($formRegister),showPassword()):hash&&("#login"==hash?showLogin():"#register"==hash?showRegister():"#password"==hash&&showPassword()),attachDialogClickHandlers();var $splashLogin=$(".splash .login-form"),$registerLink=$splashLogin.find(".register a");if($splashLogin.length>0){var usernameInput="#edit-name",$usernameInput=$(usernameInput),usernameLength=2*$usernameInput.val().length,passwordInput="#edit-pass";setInterval(function(){$usernameInput.val().length>0&&$('label[for="'+$usernameInput.attr("id")+'"]').hide(),($(passwordInput).val().length>0||$(passwordInput+":-webkit-autofill").length>0)&&$('label[for="'+$(passwordInput).attr("id")+'"]').hide()},200),$usernameInput.focus(),$usernameInput[0].setSelectionRange(usernameLength,usernameLength),$registerLink.on("click",function(){SP.logEvent({name:"private register open dialog"})})}}}}(SP.Login={},SP.jQuery);
SP.jQuery(document).ready(function($){});
!function(Self,$){Self.init=function(){function openArchiveNotice($link){var archive_url=$link.prop("href");$("#dlgArchive").rrDialog(),$("button.continue","#dlgArchive").off(),$("button.continue","#dlgArchive").on("click",function(){$("#dlgArchive").dialog("close");var win=window.open(archive_url,"_blank");win.focus()}),$("a.cancel","#dlgArchive").off(),$("a.cancel","#dlgArchive").on("click",function(){return $("#dlgArchive").dialog("close"),!1})}$("li.archive a","#nice-menu-main-menu").on("click",function(){var $link=$(this);return openArchiveNotice($link),!1}),$("p.title span a.archive","#block-smartparticipation-core-closed-proposals").on("click",function(){var $link=$(this);return openArchiveNotice($link),!1})}}(SP.Menu={},SP.jQuery);
!function(Self,$){var menuSelector="#mmenu_left";Self.isVisible=function(){return $(menuSelector).is(":visible")},Self.close=function(){$(menuSelector).data("mmenu").close()}}(SP.MobileMenu={},jQuery);
SP.jQuery(document).ready(function($){$("#multiAccordion").multiAccordion(),$("#multiAccordion").multiAccordion("option","active",[0])});

!function(Self,$){Self.init=function(){$(".proposal-phases ul.tabs").each(function(){var $active,$content,$links=$(this).find("a");$active=$links.filter('[href="'+location.hash+'"]').first(),$active.length||($active=$links.filter(".active")),$active.length||($active=$links.first()),$active.addClass("active"),$content=$($active.attr("href")),$links.not($active).each(function(){$($(this).attr("href")).hide()}),$(this).on("click","a",function(e){$active.removeClass("active"),$content.hide(),$active=$(this),$content=$($(this).attr("href")),$active.addClass("active"),$content.show(),$(".rs-carousel").carousel("refresh"),e.preventDefault()})})}}(SP.ProposalPhaseTabs={},SP.jQuery);
!function(Self,$){var messages,$messages=$("#messages");Self.init=function(){Self.showInterestSurvey()},Self.showInterestSurvey=function(){$("#dlgInterestSurvey").rrDialog({width:650})},Self.attachDialogClickHandler=function($container){$container.find("a").click(function(){return Self.showInterestSurvey(),!1})},$messages.length&&($messages.hide(),messages=$messages.html(),$("#dlgInterestSurvey .content").prepend(messages))}(SP.InterestSurvey={},SP.jQuery);
!function(Self,$){var dialogOpenOnLoad,resizeLastActiveBreakpoint,subtopicHeader="div.subtopic_title",subtopicBody="div.subtopic_body",subtopicDetails="div.subtopic-details",subtopicText="div.subtopic_text",subtopicComments="div.subtopic_comments",commentsForm="form.comment-form",commentsFormContainer="div.comments-form-container",commentsContainer="div.comments-container",commentText=".comment-text",commentButton="[id^='edit-submit']",commentCancelButton=".cancel-comment",commentAddLink=".comment-add-link a",commentAddLinkSave="button.comment-add-link-save",commentAddLinkCancel="a.comment-add-link-cancel",commentAddLinkFields="div.comment-add-link-fields",commentTipsData="div.comment-tips-alert-data",commentTipsButton="a.comment-tips-button",endorsementUsers=".endorsement-users",endorsementUsersDialog="#dlgCommentEndorsementsUsers",endorseButton=".comment-endorse a",showEndorsementUsersLink="a.show-users",replyButton=".comment-reply a",recommendedFilter="a.recommended-filter",expandAllLink=".expand-all a",collapseAllLink=".collapse-all a",parser=new UAParser,os=parser.getOS(),browser=parser.getBrowser(),isWin81=!1,isIE11=!1,isiOS=!1,isWin10=!1,isEdge=!1,isLoggedIn=$("body").hasClass("logged-in"),lastActiveBreakpoint=SP.Breakpoint.getActiveBreakpoint();"Windows"==os.name?("8.1"==os.version&&(isWin81=!0),"10"==os.version&&(isWin10=!0),"IE"==browser.name?"11.0"==browser.version&&(isIE11=!0):"Edge"==browser.name&&(isEdge=!0)):"iOS"==os.name&&(isiOS=!0),Self.init=function(){Self.isTopicPage()&&(dialogOpenOnLoad=SP.Dialog.dialogOpen(),Self.Subtopic.init(),Self.Comment.init(),Self.TopicHeaderMenu.init(),window.onbeforeunload=function(){var commentTextFound=Self.Comment.commentTextNotSubmitted();return commentTextFound?(Self.Comment.logUnsubmittedCommentText(),"It looks like you've entered text in a comment box but didn't submit it."):void 0},$(window).on("hashchange",function(){var subtopic,active,$accordion=$(subtopicDetails);Self.TopicState.getHashUpdated()||(subtopic=Self.Scroll.checkSubtopicHash())&&($accordion.multiAccordion("option","active","none"),active=Self.Scroll.processActiveSubtopic(subtopic),$accordion.multiAccordion("option","active",active)),Self.TopicState.setHashUpdated(!1)}))},Self.isTopicPage=function(){return $("body").hasClass("node-type-sp-topic")},Self.TopicState={_storageVarName:"topicState",_hashUpdated:!1,setStoredState:function(){var cvalue,expires=new Date;return(cvalue=Self.TopicState.getCurrent(!0))&&(expires.setTime(expires.getTime()+36e5),document.cookie=Self.TopicState._storageVarName+"="+JSON.stringify(cvalue)+"; expires="+expires.toGMTString()),!1},getStoredState:function(){var cdata,data;return cdata=document.cookie.split(";"),$.each(cdata,function(i,cvalue){return cvalue=cvalue.split("="),cvalue[0]==Self.TopicState._storageVarName?(data=cvalue[1],void 0):void 0}),data?((!SP.Dialog.dialogOpen()||isLoggedIn)&&Self.TopicState.deleteStoredState(),$.parseJSON(data)):!1},deleteStoredState:function(){var expires=new Date;expires.setTime(expires.getTime()-1),document.cookie=Self.TopicState._storageVarName+"=; expires="+expires.toGMTString()},getCurrent:function(setStoredState){var $openSubtopicHeaders=$(subtopicHeader+".ui-state-active"),subtopicNodeIds=new Array,hash=window.location.hash;if($openSubtopicHeaders.each(function(){subtopicNodeIds.push($(this).data("rr-event_entity-id"))}),subtopicNodeIds.length)return subtopicNodeIds.length==$(subtopicHeader).length?"all":subtopicNodeIds;if(setStoredState){if("all"==hash.substr(1,3))return"all";if("nid-"==hash.substr(1,4))return hash.split("-").slice(1)}return!1},updateHash:function(value){var subtopicNodeIds,hashValue="";void 0===value?(subtopicNodeIds=Self.TopicState.getCurrent())&&("all"==subtopicNodeIds?hashValue="all":subtopicNodeIds instanceof Array&&(hashValue="nid",$.each(subtopicNodeIds,function(i,nid){hashValue+="-"+nid}))):hashValue=value,this.setHashUpdated(!0),window.location.hash=hashValue},getHashUpdated:function(){return this._hashUpdated},setHashUpdated:function(value){this._hashUpdated=value}},Self.TopicHeaderMenu={init:function(){var $menu=$("#topic-page");$menu.find("li").each(function(){var $link=$(this).find("a");$link.find("span.future-phase").length?$link.click(function(){return Self.TopicHeaderMenu.alert($link,"unavailable")}):$link.attr("href").length<=1&&$link.click(function(){return Self.TopicHeaderMenu.alert($link,"no-topics")})})},alert:function($link,type){var id,message,idText=$link.text().toLowerCase().split(" ").join("-"),linkText=$link.text();switch(type){case"no-documents":id="no-"+idText+"-alert",message="There are no "+linkText+" to display.";break;case"no-topics":id="no-"+idText+"-alert",message="There are no "+linkText+" topics to display.";break;case"unavailable":id=idText+"-alert",message="The "+linkText+" phase is currently unavailable."}return SP.Alert.open(id,message),!1}},Self.Subtopic={_expandAllClicked:!1,_expandAllOpenedCount:0,_subtopicScrollSpeed:1500,_scrollToMultipleOpenedCount:0,windowHeight:null,windowWidth:null,init:function(){function preventSmoothScroll(event,delta){event.preventDefault();var wd=delta,csp=window.pageYOffset;window.scrollTo(0,csp-wd)}var $subtopicDetails=$(subtopicDetails),$commentsFormContainer=$(commentsFormContainer),$commentsContainer=$(commentsContainer),$expandAllLink=$(expandAllLink),$collapseAllLink=$(collapseAllLink),subtopic=Self.Scroll.checkSubtopicHash(),comment=Self.Scroll.checkCommentHash(),totalSubtopics=$(subtopicHeader).length;$subtopicDetails.multiAccordion({header:subtopicHeader,body:subtopicBody,init:function(){$subtopicDetails.css("visibility","visible")},tabShownComplete:function(event,ui){var $subtopicBody=ui.tab.next(),scrolledFromHash=!1,subtopicToScrollTo=!1;Self.Subtopic.checkContentHeight($subtopicBody),Self.Scroll.hasScrolled()||SP.Dialog.dialogOpen()||(subtopic&&!dialogOpenOnLoad&&(scrolledFromHash=!0,"all"==subtopic?(Self.Subtopic._scrollToMultipleOpenedCount++,Self.Subtopic._scrollToMultipleOpenedCount==totalSubtopics&&(subtopicToScrollTo=1)):subtopic instanceof Array?(Self.Subtopic._scrollToMultipleOpenedCount++,Self.Subtopic._scrollToMultipleOpenedCount==subtopic.length&&(subtopicToScrollTo=subtopic.sort()[0])):subtopicToScrollTo=subtopic,subtopicToScrollTo&&Self.Scroll.scrollToSubtopic(subtopicToScrollTo)),comment&&(scrolledFromHash=!0,Self.Scroll.scrollToComment(comment))),scrolledFromHash||SP.Dialog.dialogOpen()||(Self.Subtopic._expandAllClicked?(Self.Subtopic._expandAllOpenedCount++,Self.Subtopic._expandAllOpenedCount==totalSubtopics&&(Self.Subtopic._expandAllClicked=!1,Self.Subtopic._expandAllOpenedCount=0,Self.Scroll.scrollToSubtopicAnimate($(subtopicHeader+":first"),Self.Subtopic._subtopicScrollSpeed))):Self.Scroll.scrollToSubtopicAnimate($subtopicBody.prev(),Self.Subtopic._subtopicScrollSpeed)),Self.Subtopic.checkViewPort()},tabHiddenStart:function(event,ui){var $subtopicHeader=ui.tab,$subtopicBody=$subtopicHeader.next();"fixed"==$subtopicHeader.css("position")&&Self.Scroll.scrollToElement($subtopicBody)},tabHiddenComplete:function(event,ui){var $subtopicHeader=ui.tab,$subtopicBody=$subtopicHeader.next();"relative"!=$subtopicHeader.css("position")&&$subtopicHeader.css("position","relative"),$subtopicBody.find(subtopicComments).css("position","fixed")&&$subtopicBody.find(subtopicComments).css("position","static"),void 0!=$subtopicHeader.data("topSpacer")&&$subtopicBody.css("padding-top",parseFloat($subtopicBody.css("padding-top"))-$subtopicHeader.outerHeight()),$(subtopicHeader).show(),Self.Subtopic.checkViewPort()},tabHidden:function(event,ui){var $subtopicHeader=ui.tab,$subtopicBody=$subtopicHeader.next(),$forms=$subtopicBody.find("form");$forms.each(function(i,form){var $form=$(form);SP.Form.clearCommentErrorAndValue($form)})}}),(subtopic||comment)&&Self.Scroll.init($subtopicDetails,subtopic,comment),$commentsContainer.scroll(function(){var $this=$(this);Self.Scroll.getAutoScrollToComment()||($this.off("scroll"),SP.logEvent({name:"scroll comments",entity_type:"node",entity_id:$this.closest(".comment-wrapper").data("rr-event_entity-id")}))}),$expandAllLink.click(function(){return Self.Subtopic._expandAllClicked=!0,$subtopicDetails.multiAccordion("option","active","all"),Self.TopicState.updateHash("all"),SP.logEvent({name:"expand all subtopics"}),!1}),$collapseAllLink.click(function(){return $subtopicDetails.multiAccordion("option","active","none"),Self.TopicState.updateHash(""),SP.logEvent({name:"collapse all subtopics"}),!1}),$(subtopicHeader).click(function(){var $this=$(this),eventName=($this.hasClass("ui-state-active")?"open":"close")+" subtopic";Self.TopicState.updateHash(),SP.logEvent({name:eventName,entity_type:"node",entity_id:$this.data("rr-event_entity-id")})}),Self.Subtopic.windowHeight=$(window).height(),Self.Subtopic.windowWidth=$(window).width(),(isWin81&&isIE11||isWin10&&isEdge)&&($("body").on("mousewheel",function(){preventSmoothScroll(event,event.wheelDelta)}),$(document).keydown(function(){switch(event.keyCode){case 38:preventSmoothScroll(event,120);break;case 40:preventSmoothScroll(event,-120)}})),$(window).scroll(Self.Subtopic.checkViewPort),$(window).resize(function(){var newWindowHeight=$(window).height(),newWindowWidth=$(window).width();(Self.Subtopic.windowHeight!=newWindowHeight||Self.Subtopic.windowWidth!=newWindowWidth)&&Self.Subtopic.checkViewPort(),Self.Subtopic.windowHeight=newWindowHeight,Self.Subtopic.windowWidth=newWindowWidth,SP.Breakpoint.getActiveBreakpoint()!=resizeLastActiveBreakpoint&&(resizeLastActiveBreakpoint=SP.Breakpoint.getActiveBreakpoint(),Self.Subtopic.destroyResizablePanelsBehavior(),Self.Subtopic.applyResizablePanelsBehavior())}),resizeLastActiveBreakpoint=SP.Breakpoint.getActiveBreakpoint(),Self.Subtopic.applyResizablePanelsBehavior(),$commentsFormContainer.mutate("height",function(){Self.Subtopic.checkViewPort()})},isSimpleScrollDevice:function(){return SP.Breakpoint.isPhone()||SP.Breakpoint.isTablet()||isiOS},destroyResizablePanelsBehavior:function(){var $subtopicText=$(subtopicText);$subtopicText.each(function(){void 0!==$(this).resizable("instance")&&($(this).resizable("destroy"),$(this).removeAttr("style"))})},applyResizablePanelsBehavior:function(){if(SP.Breakpoint.isDesktop()){var activeLimits,$subtopicText=$(subtopicText),activeBreakpoint=SP.Breakpoint.getActiveBreakpoint(),breakpointLimits={lgDevice:{maxWidth:800,minWidth:300},mdDevice:{maxWidth:650,minWidth:300}};activeLimits=breakpointLimits[activeBreakpoint],$subtopicText.resizable({handles:"e",maxWidth:activeLimits.maxWidth,minWidth:activeLimits.minWidth,resize:function(event,ui){var currentWidth=ui.size.width,$subtopicText=$(this),$subtopicComments=$subtopicText.closest(subtopicBody).find(subtopicComments),containerWidth=$subtopicText.closest(subtopicBody).width(),subtopicCommentsPaddingMargin=$subtopicComments.outerWidth(!0)-$subtopicComments.innerWidth(),subtopicTextPaddingMargin=$subtopicText.outerWidth(!0)-$subtopicText.innerWidth(),totalPaddingMargin=subtopicCommentsPaddingMargin+subtopicTextPaddingMargin;$subtopicText.width(currentWidth),$subtopicComments.width(containerWidth-currentWidth-totalPaddingMargin),Self.Subtopic.checkViewPort()}})}},applyResizableTextareaBehavior:function($textareaWrapper,isReply){return},checkViewPort:function(){return Self.Subtopic.isSimpleScrollDevice()?($(commentsContainer).removeAttr("style"),$(subtopicComments).removeAttr("style"),$(subtopicText).removeAttr("style"),$(subtopicBody).removeAttr("style"),$(subtopicHeader).each(function(){$(this).hasClass("ui-state-active")&&$(this).next().css("display","block")}),$(subtopicHeader).removeAttr("style"),void 0):(SP.Breakpoint.getActiveBreakpoint()!=lastActiveBreakpoint&&($(subtopicHeader).removeAttr("style"),$(subtopicComments).removeAttr("style"),$(subtopicBody).css("padding-top",""),lastActiveBreakpoint=SP.Breakpoint.getActiveBreakpoint(),Self.Subtopic.checkViewPort()),$(subtopicText).each(function(){if("block"==$(this).parent().css("display")){var commentsHeight,commentsWidth,commentsLeft,commentsBottom,$element=$(this),$body=$element.parent(),bodyOffset=$body.offset(),$header=$body.prev(),headerOffset=$header.offset(),headerHeight=$header.outerHeight(),headerWidth=$header.width(),$comments=$element.next(),$commentsContainer=$comments.find(commentsContainer),$commentsFormContainer=$comments.find(commentsFormContainer),commentsFormContainerHeight=$commentsFormContainer.height(),offset=$element.offset(),$window=$(window),windowTop=$window.scrollTop(),windowLeft=$window.scrollLeft(),windowBottom=windowTop+$window.height(),bodyMarginTop="auto"==$body.css("margin-top")?"0":$body.css("margin-top"),bodyTopSpacer=parseFloat($header.css("margin-bottom"))+parseFloat($body.css("padding-top"))+parseFloat(bodyMarginTop),topSpacer=headerHeight+bodyTopSpacer,$nextHeader=$(subtopicHeader).eq($(subtopicHeader).index($header)+1),$subtopicDetails=$element.parent(),textMarginBottom=parseFloat($element.css("margin-bottom"));$nextHeader.length?headerOffset.top>=$nextHeader.offset().top?$header.hide():$header.show():headerOffset.top+headerHeight>offset.top+$element.height()?$header.hide():$header.show(),"relative"!=$header.css("position")&&$header.data("originalOffsetTop")>=windowTop&&($header.css("position","relative"),$header.css("left","auto"),$body.css("padding-top",parseFloat($body.css("padding-top"))-headerHeight)),"fixed"!=$header.css("position")&&headerOffset.top<windowTop&&($header.data("originalOffsetTop",headerOffset.top),$header.data("topSpacer",topSpacer),$header.css("position","fixed"),$header.css("top","0px"),$header.width(headerWidth),$body.css("padding-top",parseFloat($body.css("padding-top"))+headerHeight)),"fixed"==$header.css("position")?(commentsWidth=$comments.width(),$comments.width(commentsWidth),$comments.css("position","fixed"),commentsLeft=bodyOffset.left+parseFloat($body.css("margin-left"))+$body.outerWidth()-($body.outerWidth()-$body.width())/2-$comments.outerWidth()-windowLeft,$comments.css("top",$header.data("topSpacer")),$comments.css("left",commentsLeft),$comments.css("right","0px"),windowLeft>0?$header.css("left",-windowLeft):$header.css("left","auto")):(offset.top>windowTop&&"fixed"==$comments.css("position")&&$comments.css("position","static"),offset.top+$element.height()<windowBottom&&void 0!=$header.data("topSpacer")&&(topSpacer=$header.data("topSpacer"))),$(subtopicComments).length&&(commentsBottom=$nextHeader.length?$nextHeader.offset().top-textMarginBottom:$subtopicDetails.offset().top+$subtopicDetails.outerHeight(),commentsBottom>windowBottom&&(commentsBottom=windowBottom),commentsHeight=Math.round(commentsBottom-$comments.offset().top),0>commentsHeight&&(commentsHeight=0),$comments.height(commentsHeight),$commentsContainer.height(commentsHeight-commentsFormContainerHeight)),$body.data("lastWindowTop",windowTop)}}),void 0)},checkContentHeight:function($subtopicBody){$subtopicBody.hasClass("subtopic_body")||($subtopicBody=$(this).closest(subtopicBody));var commentsHeight,$content=$subtopicBody.find(subtopicText),contentHeight=$content.height(),$commentsContainer=$subtopicBody.find(commentsContainer),$subtopicComments=$subtopicBody.find(subtopicComments),$subtopicText=$subtopicBody.find(subtopicText),bodySpacing=$subtopicBody.outerHeight()-$subtopicBody.height()+($subtopicText.outerHeight(!0)-$subtopicText.height()),maxCommentsHeight=$(window).height()-2*$(subtopicHeader+":first").outerHeight(!0)-bodySpacing;$subtopicComments.height("auto"),$commentsContainer.height("auto"),commentsHeight=$subtopicBody.find(".comment-wrapper").height(),commentsHeight>contentHeight&&(commentsHeight>maxCommentsHeight?maxCommentsHeight>contentHeight&&($content.height(maxCommentsHeight),$subtopicComments.height(maxCommentsHeight),$subtopicBody.height(maxCommentsHeight+parseFloat($subtopicText.css("margin-bottom")))):($content.height(commentsHeight),$subtopicBody.height(commentsHeight+parseFloat($subtopicText.css("margin-bottom"))))),this.checkViewPort()}},Self.Scroll={_scrolled:!1,_autoScrollToComment:!1,init:function($subtopic,subtopic,comment){var $comment,active;subtopic&&(active=this.processActiveSubtopic(subtopic),$subtopic.multiAccordion("option","active",active)),comment&&($comment=$("#comment-wrapper-"+comment),$comment.length&&(subtopic=this._getSubtopic($comment),$subtopic.multiAccordion("option","active",[subtopic-1])))},processActiveSubtopic:function(subtopic){return"all"==subtopic?active="all":subtopic instanceof Array?(active=new Array,$.each(subtopic,function(i,v){active.push(v-1)})):active=[subtopic-1],active},checkCommentHash:function(){var cid,hash=window.location.hash;return"cid-"!=hash.substr(1,4)||(cid=parseInt(hash.split("-").pop()),isNaN(cid))?!1:cid},checkSubtopicHash:function(){{var nodeId,subtopicIndex,newHashValue,hash=window.location.hash,hashVal=parseInt(hash.substr(1)),nodeIds=new Array,subtopics=new Array;$(".ui-dialog")}if("all"==hash.substr(1,3))return"all";if("nid-"==hash.substr(1,4)){if(nodeIds=hash.split("-"),nodeIds.length>2){if($.each(nodeIds,function(i,nid){isNaN(nid)||(subtopicIndex=Self.Scroll.getSubtopicIndex(nid))&&subtopics.push(subtopicIndex)}),subtopics.length)return subtopics}else if(nodeId=nodeIds.pop(),!isNaN(nodeId)&&(subtopicIndex=Self.Scroll.getSubtopicIndex(nodeId)))return subtopicIndex}else if(!isNaN(hashVal))return hashVal;if(nodeIds=Self.TopicState.getStoredState()){if("all"==nodeIds)return Self.TopicState.updateHash("all"),"all";if($.each(nodeIds,function(i,nid){(subtopicIndex=Self.Scroll.getSubtopicIndex(nid))&&(newHashValue||(newHashValue="nid"),newHashValue+="-"+nid,subtopics.push(subtopicIndex))}),subtopics.length)return Self.TopicState.updateHash(newHashValue),1==subtopics.length?subtopics[0]:subtopics}return!1},getSubtopicIndex:function(subtopicNodeId){var $subtopicHeader=$(subtopicHeader+'[data-rr-event_entity-id="'+subtopicNodeId+'"]');return $subtopicHeader.length?$subtopicHeader.attr("id").split("-").pop():!1},scrollToElement:function($element){$(window).scrollTop($element.offset().top)},scrollToSubtopic:function(subtopic){var $subtopic=$("#subtopic-title-"+subtopic);$subtopic.length&&this.scrollToElement($subtopic),this._scrolled=!0},scrollToSubtopicAnimate:function($subtopicHeader,speed){$("html,body").animate({scrollTop:$subtopicHeader.offset().top},speed,"easeOutQuint")},scrollToComment:function(comment){var $comment,$commentsContainer;return $comment=$("#comment-wrapper-"+comment),Self.Subtopic.isSimpleScrollDevice()?(this.scrollToElement($comment),void 0):($comment.length&&($commentsContainer=$comment.closest(commentsContainer),subtopic=this._getSubtopic($comment),$(window).scrollTop($("#subtopic-title-"+subtopic).offset().top),setTimeout(function(){Self.Scroll._scrollToCommentAnimated($comment,$commentsContainer)},500)),this._scrolled=!0,void 0)},scrollToNewComment:function(commentNumber){var $commentWrapper=$("#comment-wrapper-"+commentNumber),$commentsContainer=$commentWrapper.closest(commentsContainer);return Self.Subtopic.isSimpleScrollDevice()?(this.scrollToElement($commentWrapper),void 0):(setTimeout(function(){Self.Scroll._scrollToCommentAnimated($commentWrapper,$commentsContainer)},200),void 0)},_scrollToCommentAnimated:function($commentWrapper,$commentsContainer){$commentsContainer.animate({scrollTop:$commentWrapper.offset().top+$commentsContainer.scrollTop()-$commentsContainer.offset().top},{duration:1e3,easing:"easeOutQuint",start:function(){Self.Scroll.setAutoScrollToComment(!0)},always:function(){Self.Scroll.setAutoScrollToComment(!1)},complete:function(){Self.Scroll._highlightCommentText($commentWrapper.find(".comment-text:first"))}})},_highlightCommentText:function($commentText){$commentText.effect("highlight",{color:"#f4f4f4"},3e3)},scrollToReplyOrRedactForm:function($formElement){var $form,$commentsContainer=$formElement.closest(commentsContainer);$form=$formElement.is("form")?$formElement:$formElement.closest("form");var scrollAnimate=function(){setTimeout(function(){$commentsContainer.animate({scrollTop:$form.offset().top-($commentsContainer.height()-$form.outerHeight())+$commentsContainer.scrollTop()-$commentsContainer.offset().top},"slow")},150)};if(Self.Comment.areClosingForms($form))var intervalId=setInterval(function(){Self.Comment.areClosingForms($form)||(scrollAnimate(),clearInterval(intervalId))},50);else scrollAnimate()},_getSubtopic:function($comment){return parseInt($comment.closest("div.subtopic_body").attr("id").split("-").pop())},hasScrolled:function(){return this._scrolled},getAutoScrollToComment:function(){return this._autoScrollToComment},setAutoScrollToComment:function(value){this._autoScrollToComment=value}},Self.Comment={_formFadeTime:1e3,_formFadeOpacity:.35,init:function(){this.numberComments($(subtopicBody)),this.Filter.init(),this.Endorse.init(),this.CommentTips.init(),SP.Login.isLoggedIn()?$("#dlgInterestSurvey").length?this.interestSurveyNotSubmitted():this.cancelCommentInput():this.notLoggedIn()},commentTextNotSubmitted:function(){for(instanceKey in CKEDITOR.instances)if(CKEDITOR.instances[instanceKey].getData())return!0;return!1},logUnsubmittedCommentText:function(){var $editor,subtopicNid,commentText;for(instanceKey in CKEDITOR.instances)commentText=CKEDITOR.instances[instanceKey].getData(),commentText&&($editor=$("#"+instanceKey),subtopicNid=$editor.closest(".comment-wrapper").data("rr-event_entity-id"),SP.EventLogger.log({name:"comment text beforeunload",entity_type:"node",entity_id:subtopicNid,detail_long:commentText},!1))},interestSurveyNotSubmitted:function(){function getMessage(fragment){return"Please complete the "+link+" in order to "+fragment+"."}var link=Drupal.settings.rrAlert.interestSurveyLink;this.disableCommenting(getMessage,"interest-survey")},notLoggedIn:function(){function getMessage(fragment){return Self.Comment.getLoginRequiredAlertMessage(fragment)}this.disableCommenting(getMessage,"login")},getLoginRequiredAlertMessage:function(fragment){var alertSettings=Drupal.settings.rrAlert,loginLink=alertSettings.loginLink,registerLink=alertSettings.registerLink;return"Login required. Please "+loginLink+" or "+registerLink+" to "+fragment+"."},openLoginRequiredCommentAlert:function(){SP.Alert.open("comment-alert",this.getLoginRequiredAlertMessage("make a comment"),"login")},disableCommenting:function(getMessage,type){$(commentsForm+" textarea").prop("readonly",!0),$(commentsForm+" .form-textarea-wrapper").on("click",function(){SP.Alert.open("comment-alert",getMessage("make a comment"),type)}),jQuery(commentsForm+" input.form-submit").unbind(),$(commentsForm+' input[type="submit"]').unbind().on("click",function(){return SP.Alert.open("comment-alert",getMessage("make a comment"),type),!1}),$(endorseButton).unbind().on("click",function(){return SP.Alert.open("endorse-alert",getMessage("endorse a comment"),type),!1}),$(replyButton).unbind().on("click",function(){return SP.Alert.open("reply-alert",getMessage("make a reply"),type),!1})},getCommentText:function($commentForm){var instanceKey=$commentForm.find("textarea").attr("id"),editor=CKEDITOR.instances[instanceKey];return editor.getData()},focusOnCommentBox:function($commentForm){var instanceKey=$commentForm.find("textarea").attr("id"),editor=CKEDITOR.instances[instanceKey],data=this.getCommentText($commentForm);editor.setData(data,function(){editor.focus();var range=editor.createRange();range.moveToElementEditEnd(range.root),editor.getSelection().selectRanges([range])})},userIsModerator:function(){return $("body").hasClass("moderator")},getThrobber:function(){return'<div class="ajax-progress ajax-progress-throbber"><div class="throbber">&nbsp;</div></div>'},showCommentSubmitThrobber:function(commentForm){var $commentForm=$("#"+commentForm);setTimeout(function(){$commentForm.find(".ajax-progress-throbber").remove(),$commentForm.find(".form-actions .form-submit:first").before(Self.Comment.getThrobber()),$commentForm.find(".form-actions .ajax-progress").css("display","inline-block")},1)},removeCommentSubmitThrobber:function($container){$container.find(".form-actions .ajax-progress").remove()},cancelCommentInput:function(){$(commentCancelButton).each(function(){var $cancelButton=$(this);$cancelButton.data("cancelBehaviorEnabled")||($cancelButton.data("cancelBehaviorEnabled",!0),$(this).on("click",function(){var $form=$(this).closest("form");return SP.Form.clearCommentValue($form),!1}))})},numberComments:function($subtopicBody,filter){$subtopicBody.each(function(){var $comments,$subtopicBody=$(this);$subtopicBody.hasClass("subtopic_body")||($subtopicBody=$(this).closest(subtopicBody)),$comments=$subtopicBody.find(".comment"),filter&&($comments=$comments.filter(":visible")),$comments.each(function(index){$(this).find(".comment-number").text(index+1)})})},updateRecommendedCount:function(action){this.updateCommentCount(null,"recommended",action)},updateCommentCount:function($subtopicBody,dataType,action){var subtopic,selectors,icon,value;switch(null!==$subtopicBody&&($subtopicBody.hasClass("subtopic_body")||($subtopicBody=$subtopicBody.closest(subtopicBody)),subtopic=$subtopicBody.attr("id").split("-")[2]),void 0===dataType&&(dataType="comment"),void 0===action&&(action="add"),dataType){case"recommended":selectors=["div.topic.carousel-container a.active + span.count + span.count"];break;case"comment":selectors=["div.topic.carousel-container a.active + span.count",'[data-type="comment-count-topic"]',"#subtopic-body-"+subtopic+' [data-type="comment-count-subtopic"]',"#subtopic-title-"+subtopic+' [data-type="comment-count-subtopic"]']}void 0!==selectors&&$(selectors.join(",")).each(function(){icon=null,$(this).children().length&&(icon=$(this).children().clone()),value=parseInt($(this).text()),"remove"==action?value--:value++,$(this).text(value),null!==icon&&$(this).append(icon)})},afterComment:function($comment){var $subtopicBody=$comment.closest(subtopicBody),commentId=$comment.attr("id").split("-").pop();this.numberComments($subtopicBody),this.updateCommentCount($subtopicBody),Self.Subtopic.checkContentHeight($subtopicBody),SP.Form.clearFormErrors($subtopicBody.find("form.comment-form")),this.removeCommentSubmitThrobber($subtopicBody),Self.Comment.CommentTips.shouldLogCommentSubmit&&Self.Comment.CommentTips.logCommentSubmit(commentId)},afterModeratorCommment:function($commentWrapper){var cid,$replyButton,$replies,$parent=$commentWrapper.parent();SP.ModeratorControls.ModeratorControls.applyClickListeners($commentWrapper),$parent.hasClass("ajax-comment-wrapper")&&(cid=$parent.attr("id").split("-").pop(),$replyButton=$parent.find(".ajax-comment-reply:first"),$replyButton.detach(),$.getJSON(Drupal.settings.basePath+"comment/"+cid+"/render",function(data){$replies=$parent.find(".ajax-comment-wrapper"),$replies.detach(),$parent.replaceWith(function(){return $(data.html).append($replies)}),$parent=$("#"+$parent.attr("id")),SP.ModeratorControls.ModeratorControls.applyClickListeners($parent),$parent.find(".ajax-comment-reply:first").replaceWith($replyButton),Self.Comment.numberComments($commentWrapper.closest(subtopicBody))}))},afterReply:function($commentWrapper){var $subtopicBody=$commentWrapper.closest(subtopicBody),$comment=$commentWrapper.find(".comment:first");$parentCommentWrapper=$commentWrapper.parent(),lastActiveReplyBoxId=$parentCommentWrapper.data("lastActiveReplyBoxId"),CKEDITOR.instances[lastActiveReplyBoxId].destroy(),this.enableCommentForm($commentWrapper.closest(".comment-wrapper").find(".comments-form-container form.comment-form")),$commentWrapper.parent().find("a.ajax-comment-reply").show(),this.numberComments($subtopicBody,$subtopicBody.find(subtopicComments).data("active-filter")),this.updateCommentCount($subtopicBody),Self.Subtopic.checkContentHeight($subtopicBody),SP.Form.clearFormErrors($subtopicBody.find("form.comment-form")),this.removeCommentSubmitThrobber($subtopicBody),this.toggleRedactButton($comment);var parentId="#"+$parentCommentWrapper.attr("id"),intervalId=setInterval(function(){var $parentWrapper=jQuery(parentId),$redactButton=$parentWrapper.find("ul.links:first .comment-redact a");$redactButton.length||clearInterval(intervalId),$redactButton.hasClass("ajax-processed")||(Drupal.attachBehaviors($redactButton),clearInterval(intervalId))},50);setTimeout(function(){var $parentComment=$(parentId),$endorsementUsersLink=$parentComment.find(showEndorsementUsersLink);Self.Comment.Endorse.applyShowUsersClick($endorsementUsersLink)},1e3)},afterCommentFormReplace:function($commentForm){if($commentForm.find("label").inFieldLabels(),this.cancelCommentInput(),Self.Comment.CommentTips.clonedButtons.length>0){var commentButtonSelector=commentsForm+" "+commentButton,$commentSubmitButton=$commentForm.find(commentButton),index=$commentSubmitButton.index(commentButtonSelector),$clonedButton=Self.Comment.CommentTips.getClonedOriginalSubmitButton($commentSubmitButton);Self.Comment.CommentTips.storeClonedOriginalSubmitButton($clonedButton,index)}},afterError:function($commentForm){$(commentTipsData).data("promptEnabled")&&Self.Comment.CommentTips.applyPromptClick($commentForm.find("[id^='edit-submit']"))},afterReplyError:function($commentForm){$commentForm.find("label").inFieldLabels(),Self.Scroll.scrollToReplyOrRedactForm($commentForm)},areClosingForms:function($activeForm){return Self.Comment.getClosingForms($activeForm).length?!0:!1},getClosingForms:function($activeForm){var $commentsContainer=$activeForm.closest(commentsContainer);return $commentsContainer.find('form.comment-form:visible:not([id="'+$activeForm.attr("id")+'"])')},afterOpenRedactForm:function($formElement){var $editForm=$formElement.closest("form"),$commentForm=$editForm.closest(".comment-wrapper").find(".comments-form-container form"),$commentsContainer=$editForm.closest(commentsContainer),$replyForms=$commentsContainer.find('form.comment-form:not([id="'+$editForm.attr("id")+'"])'),$commentTextarea=$editForm.find("textarea"),$commentWrapper=$commentTextarea.closest(".ajax-comment-wrapper");$commentWrapper.data("lastActiveEditorId",$commentTextarea.attr("id")),this.disableCommentForm($commentForm),this.closeVisibleReplyAndRedactForms($replyForms),Self.Scroll.scrollToReplyOrRedactForm($formElement)},afterOpenReplyForm:function($formElement){var $replyForm=$formElement.closest("form"),$comment=$replyForm.prev(),$commentForm=$replyForm.closest(".comment-wrapper").find(".comments-form-container form"),activeFilter=$replyForm.closest(subtopicComments).data("active-filter"),$commentTextarea=$replyForm.find("textarea"),$commentWrapper=$commentTextarea.closest(".ajax-comment-wrapper");$commentWrapper.data("lastActiveReplyBoxId",$commentTextarea.attr("id")),this.showReplyForm($replyForm),Self.Scroll.scrollToReplyOrRedactForm($formElement),activeFilter||this.disableCommentForm($commentForm),this.toggleRedactButton($comment)},disableCommentForm:function($commentForm){$commentForm.data("disabled",1),$commentForm.find(":input").prop("disabled",!0),$commentForm.find(commentAddLink).unbind().click(function(){return!1}),$commentForm.fadeTo(this._formFadeTime,this._formFadeOpacity)},enableCommentForm:function($commentForm){var activeFilter=$commentForm.closest(subtopicComments).data("active-filter");activeFilter||($commentForm.data("disabled",0),$commentForm.fadeTo(this._formFadeTime,1),$commentForm.find(":input").prop("disabled",!1))},showReplyForm:function($replyForm){var $commentsContainer=$replyForm.closest(commentsContainer),$replyForms=$commentsContainer.find('form.comment-form:not([id="'+$replyForm.attr("id")+'"])');$replyForm.prev().find(".ajax-comment-reply").hide(),$replyForm.hide().fadeIn(this._formFadeTime),$replyForm.find("label").inFieldLabels(),this.closeVisibleReplyAndRedactForms($replyForms)},closeVisibleReplyAndRedactForms:function($replyForms){var $form;$replyForms.each(function(){$form=$(this),$form.is(":visible")&&(Self.Comment.isReplyForm($form)?Self.Comment.cancelReplyForm($(this),!1):Self.Comment.isRedactForm($form)&&Self.Comment.cancelRedactForm($(this)))})},isRedactForm:function($form){return $form.hasClass("comment-form-edit")},isReplyForm:function($form){return $form.hasClass("comment-form-reply")
},cancelRedactForm:function($redactForm){var replyEditorInstanceKey,$cancelButton=jQuery("#"+$redactForm.attr("id")).find(".form-actions a.use-ajax"),$commentWrapper=$redactForm.parent(),$replyForm=$commentWrapper.children(".comment-form-reply"),editorInstanceKey=$redactForm.find("textarea").attr("id");delete CKEDITOR.instances[editorInstanceKey],$replyForm.length&&(replyEditorInstanceKey=$replyForm.find("textarea").attr("id"),$replyForm.remove(),delete CKEDITOR.instances[replyEditorInstanceKey]),jQuery.ajax($cancelButton.attr("href")).done(function(data){var selector=data[1].selector,comment=data[1].data;jQuery(selector).replaceWith(comment),Drupal.attachBehaviors(jQuery(selector));var commentWrapperSelector=selector.split(" ").shift(),$commentWrapper=$(commentWrapperSelector),$endorsementUsersLink=$commentWrapper.find(showEndorsementUsersLink).first();Self.Comment.Endorse.applyShowUsersClick($endorsementUsersLink)}),this.setRedactFormAutoClosed($commentWrapper)},toggleRedactButton:function($comment){var $redactButton=$comment.find(".comment-redact a");$redactButton.length&&$redactButton.toggle()},cancelReplyForm:function($replyForm,scroll){var $comment=$replyForm.prev();scroll=scroll||void 0===scroll?!0:!1;var formFadeTime=scroll?this._formFadeTime:0;this.toggleRedactButton($comment),$replyForm.fadeOut(formFadeTime,function(){var $replyButton=$replyForm.prev().find(".ajax-comment-reply"),commentNumber=$replyButton.attr("id").split("-").pop();SP.Form.clearCommentErrorAndValue($replyForm),Self.Comment.userIsModerator()?$replyButton.show():(jQuery("#"+$replyForm.attr("id")).prev().find(".ajax-comment-reply").unbind(),$replyButton.addClass("clicked").unbind().attr("href","#").show().bind({click:function(e){var commentNumber=$(this).attr("id").split("-"),$replyForm=$("#comment-wrapper-"+commentNumber[1]+" .comment-form"),$commentForm=$("#comment-wrapper-"+commentNumber[1]).closest(".comment-wrapper").find(".comments-form-container form"),activeFilter=$replyForm.closest(subtopicComments).data("active-filter");$(this).hide(),activeFilter||Self.Comment.disableCommentForm($commentForm),Self.Comment.showReplyForm($replyForm),Self.Scroll.scrollToReplyOrRedactForm($replyForm),e.preventDefault()}})),scroll&&Self.Scroll.scrollToComment(commentNumber)})},setRedactFormAutoClosed:function($commentWrapper){$commentWrapper.data("redactFormAutoClosed",!0)},getRedactFormAutoClosed:function($commentWrapper){return void 0!==$commentWrapper.data("redactFormAutoClosed")&&$commentWrapper.data("redactFormAutoClosed")?($commentWrapper.data("redactFormAutoClosed",!1),!0):!1},afterRedact:function($commentWrapper){var commentNumber=$commentWrapper.attr("id").split("-").pop(),formAutoClosed=!1,lastActiveEditorId=$commentWrapper.data("lastActiveEditorId");delete CKEDITOR.instances[lastActiveEditorId],this.getRedactFormAutoClosed($commentWrapper)&&(formAutoClosed=!0),this.enableCommentForm($commentWrapper.closest(".comment-wrapper").find(".comments-form-container form.comment-form")),this.numberComments($commentWrapper.closest(subtopicBody)),formAutoClosed||Self.Scroll.scrollToComment(commentNumber),Drupal.attachBehaviors(),Self.Comment.Endorse.applyShowUsersClick($commentWrapper.find(showEndorsementUsersLink))},AddLink:{init:function($commentForm){var $container,$commentForms,self=this;$commentForms=void 0!==$commentForm?$commentForm:$(commentsForm),$commentForms.each(function(){$(this).find(commentAddLink).unbind().click(function(){return $container=$(this).closest(commentsForm),self._toggleForm($container),!1}),$(this).find(commentAddLinkSave).unbind().click(function(){return $container=$(this).closest(commentsForm),self._insertLink($container),!1}),$(this).find(commentAddLinkCancel).unbind().click(function(){return $container=$(this).closest(commentsForm),self._toggleForm($container),!1})})},_toggleForm:function($container){$container.find(commentAddLinkFields+" input").val("").blur(),$container.find(commentAddLinkFields).slideToggle("slow",function(){$(this).find('input[id^="link-url"]').focus(),$(this).closest(".ajax-comment-wrapper").length?Self.Scroll.scrollToReplyOrRedactForm($(this)):Self.Subtopic.checkContentHeight($(this).closest(subtopicBody))}),$container.find('[id^="edit-actions"]').toggle()},_insertLink:function($container){var $fields=$container.find(commentAddLinkFields),$linkUrl=$fields.find('input[id^="link-url"]'),linkUrl=$linkUrl.val(),linkText=$fields.find('input[id^="link-text"]').val(),$textarea=$container.find("textarea");linkUrl.length?(/^(https?):\/\//i.test(linkUrl)||(linkUrl="http://"+linkUrl),linkText.length||(linkText=linkUrl),$textarea.val($textarea.val()+'<a href="'+linkUrl+'">'+linkText+"</a>").blur().focus(),this._toggleForm($container)):$linkUrl.focus()}},Endorse:{init:function(){SP.Login.isLoggedIn()&&this.applyClick($(endorseButton)),this.applyShowUsersClick($(showEndorsementUsersLink))},applyClick:function($button){$button.on("click",function(){var $button=$(this);return $button.after(Self.Comment.getThrobber()),$.ajax({url:$(this).prop("href"),type:"POST",dataType:"json",data:{js:!0},success:function(data){data.status&&"comment_endorsement"==data.flagName&&(cid=data.contentId,$commentWrapper=$("#comment-wrapper-"+cid),$commentWrapper.find(".endorsement-counter:first span").fadeOut(1500),$commentWrapper.find(".comment-endorse:first").html($(data.newLink).find("a")),Self.Comment.Endorse.applyClick($commentWrapper.find(".comment-endorse:first a")),"flagged"==data.flagStatus&&($commentWrapper.find(".endorsement-counter:first span").remove(),$commentWrapper.find(".endorsement-counter:first").append($("<span />")).find("span").hide().html("<span>"+data.endorsements+"</span> endorsement"+(data.endorsements>1?"s":"")).fadeIn(1500)))},error:function(){$button.parent().find(".ajax-progress").remove()}}),!1})},applyShowUsersClick:function($link){$link.on("click",function(){var $link=$(this),$usersList=$link.closest(commentText).find(endorsementUsers);return $(endorsementUsersDialog).html($usersList.clone()),$(endorsementUsersDialog).find(endorsementUsers).show(),$(endorsementUsersDialog).rrDialog(),!1})}},CommentTips:{clonedButtons:new Array,overlay:null,shouldLogCommentSubmit:!1,init:function(){var self=this,$commentSubmitButton=$(commentsForm).find(commentButton);$(commentTipsButton).click(function(){var eventData,subtopicNid=$(this).closest(".comment-wrapper").data("rr-event_entity-id"),$commentForm=$(this).closest(commentsFormContainer).find(commentsForm),commentText=Self.Comment.getCommentText($commentForm);return self.openAlert("button",subtopicNid),eventData={name:"open comment tips with button",entity_type:"node",entity_id:subtopicNid},commentText&&commentText.length&&(eventData.detail_long=commentText),SP.logEvent(eventData),!1}),$(commentTipsData).data("promptEnabled")&&(this.cloneOriginalSubmitButtons($commentSubmitButton),this.applyPromptClick($commentSubmitButton))},logCommentSubmit:function(commentId){var eventData={name:"comment submitted",entity_type:"comment",entity_id:commentId};SP.logEvent(eventData),this.shouldLogCommentSubmit=!1},cloneOriginalSubmitButtons:function($commentSubmitButtons){$commentSubmitButtons.each(function(index){var $originalSubmitButton=Self.Comment.CommentTips.getClonedOriginalSubmitButton($(this));Self.Comment.CommentTips.storeClonedOriginalSubmitButton($originalSubmitButton,index)})},getClonedOriginalSubmitButton:function($commentSubmitButton){var buttonID="#"+$commentSubmitButton.attr("id"),$button=jQuery(buttonID),$originalSubmitButton=$button.clone(!0);return $originalSubmitButton},storeClonedOriginalSubmitButton:function($originalSubmitButton,index){this.clonedButtons[index]=$originalSubmitButton},restoreCommentSubmitButtons:function(){var $commentSubmitButton=$(commentsFormContainer).find(commentButton);$commentSubmitButton.each(function(i){Self.Comment.CommentTips.clonedButtons[i];Self.Comment.CommentTips.restoreCommentSubmitButton($(this),Self.Comment.CommentTips.clonedButtons[i])})},restoreCommentSubmitButton:function($commentSubmitButton,$clonedButton){$commentSubmitButton.replaceWith($clonedButton)},applyPromptClick:function($commentSubmitButton){$commentSubmitButton.each(function(){{var buttonID="#"+$(this).attr("id"),$button=jQuery(buttonID);$button.clone(!0)}$button.unbind()}),$commentSubmitButton.on("click",function(){var eventData,$commentSubmitButton=$(this),subtopicNid=$commentSubmitButton.closest(".comment-wrapper").data("rr-event_entity-id"),$commentForm=$commentSubmitButton.closest(commentsFormContainer).find(commentsForm),commentText=Self.Comment.getCommentText($commentForm),commentButtonSelector=commentsForm+" "+commentButton,index=$commentSubmitButton.index(commentButtonSelector);return commentText.length&&$(commentTipsData).data("promptEnabled")?(Self.Comment.CommentTips.openAlert("comment",subtopicNid),eventData={name:"open comment tips prompt",entity_type:"node",entity_id:subtopicNid},commentText&&commentText.length&&(eventData.detail_long=commentText),SP.logEvent(eventData),!1):(Self.Comment.CommentTips.restoreCommentSubmitButton($commentSubmitButton,Self.Comment.CommentTips.clonedButtons[index]),jQuery(commentButtonSelector).eq(index).mousedown(),void 0)})},refreshState:function($subtopicBody){var subtopicNid=$subtopicBody.find(".comment-wrapper").data("rr-event_entity-id");$.get($(commentTipsData).data("getStateBaseUrl")+subtopicNid,function(data){var $commentSubmitButton;data.use_comment_tips_button?$("a.comment-tips-button").show():$("a.comment-tips-button").hide(),data.use_comment_tips_prompt?($(commentTipsData).data("promptEnabled",!0),$commentSubmitButton=$subtopicBody.find(commentButton),Self.Comment.CommentTips.applyPromptClick($commentSubmitButton)):$(commentTipsData).data("promptEnabled",!1)})},openAlert:function(method,subtopicNid){var commentTipsMarkup=$(commentTipsData).clone().html(),$commentTipsMarkup=$(commentTipsMarkup),numberOfTips=$commentTipsMarkup.find("li").length;switch($commentTipsMarkup.find("li:lt("+(numberOfTips-1)+")").prepend($("<span />").addClass("tip-divider")),method){case"button":SP.Alert.open("comment-tips-button-alert",$("<div />").addClass("comment-tips-wrapper").append($commentTipsMarkup),"comment-tips-button");break;case"comment":SP.Alert.open("comment-tips-prompt-alert",$("<div />").addClass("comment-tips-wrapper action-prompt").attr("data-subtopic-nid",subtopicNid).append($commentTipsMarkup),"comment-tips-prompt",!1),this.shouldLogCommentSubmit=!0,this.createOverlay()}},createOverlay:function(){this.overlay=$("<div>").addClass("ui-widget-overlay ui-front").appendTo($("body"))},destroyOverlay:function(){this.overlay.remove()},attachAlertActionHandlers:function($container){var $reviseCommentButton=$container.find("button.revise-comment"),$submitAsIsCommentButton=$container.find("button.submit-comment-as-is"),subtopicNid=$container.find(".comment-tips-wrapper").data("subtopicNid"),subtopicBody=".subtopic-body-node-"+subtopicNid;$reviseCommentButton.on("click",function(){SP.logEvent({name:"comment tips revise comment selected",entity_type:"node",entity_id:subtopicNid},!1),Self.Comment.CommentTips.destroyOverlay(),Self.Comment.CommentTips.refreshState($(subtopicBody)),SP.Alert.close($reviseCommentButton);var $commentForm=$(subtopicBody).find(commentsForm);return Self.Comment.focusOnCommentBox($commentForm),!1}),$submitAsIsCommentButton.on("click",function(){SP.logEvent({name:"comment tips submit comment selected",entity_type:"node",entity_id:subtopicNid},!1),Self.Comment.CommentTips.destroyOverlay(),Self.Comment.CommentTips.refreshState($(subtopicBody)),SP.Alert.close($submitAsIsCommentButton);var $commentSubmitButton=$(subtopicBody).find(commentsFormContainer).find(commentButton),commentButtonSelector=commentsForm+" "+commentButton,index=$commentSubmitButton.index(commentButtonSelector);Self.Comment.CommentTips.restoreCommentSubmitButton($commentSubmitButton,Self.Comment.CommentTips.clonedButtons[index]),jQuery(subtopicBody).find(commentsFormContainer).find(commentButton).mousedown()})}},Filter:{init:function(){$(recommendedFilter).on("click",this.showRecommended)},showRecommended:function(){var $replyForms,$filterLink=$(this),$subtopicComments=$filterLink.closest(subtopicComments),$comments=$subtopicComments.find(".comment"),$panelTitle=$subtopicComments.find("h3.title"),$commentCountWrapper=$panelTitle.find("span.comment-count").clone(),$commentForm=$subtopicComments.find(commentsFormContainer+" .comment-form"),$commentCountIcon=$commentCountWrapper.find(".comment-count-icon");return $filterLink.toggleClass("active"),$filterLink.hasClass("active")?($subtopicComments.data("active-filter",1),$filterLink.find("span").removeClass("recommended-filter-icon").addClass("comments-filter-icon"),$filterLink.prop("title","View all comments"),$panelTitle.html("Recommended comments").append($commentCountWrapper),$commentCountIcon.addClass("recommended-icon"),$commentForm.fadeOut(1e3),$comments=$comments.map(function(){return $(this).find(".recommended").length?void 0:this}),$comments.fadeOut(1e3),$comments.promise().done(function(){Self.Comment.numberComments($subtopicComments,!0)}),$commentCountWrapper.find("span:first").text($commentCountWrapper.find("span:first").text()-$comments.length),SP.logEvent({name:"view recommended comments",entity_type:"node",entity_id:$filterLink.closest(".comment-wrapper").data("rr-event_entity-id")})):($subtopicComments.data("active-filter",0),$filterLink.find("span").removeClass("comments-filter-icon").addClass("recommended-filter-icon"),$filterLink.prop("title","View recommended comments"),$panelTitle.html("Comments").append($commentCountWrapper),$commentCountIcon.removeClass("recommended-icon"),$commentForm.data("disabled")?Self.Comment.enableCommentForm($commentForm):$commentForm.fadeIn(1e3),$comments.fadeIn(1e3,function(){$replyForms=$subtopicComments.find(commentsContainer+" form.comment-form"),$replyForms.length&&Self.Comment.closeVisibleReplyAndRedactForms($replyForms)}),Self.Comment.numberComments($subtopicComments),$commentCountWrapper.find("span:first").text($comments.length)),!1}}}}(SP.Topic={},SP.jQuery);
!function(Self,$){Self.init=function(){var $arrow=$(".expand-topics"),$topicHeaderMenu=$("#topic-header-menu"),$topicHeaderMenuDoc=$(".node-type-sp-document #topic-header-menu"),$selectOtherTopics=$(".select-other-topics a"),summaryContent=$("#proposal-summary-content");$("#proposal-summary-link").click(function(e){summaryContent.is(":visible")?$("#proposal-summary-link span").removeClass("collapse-summary").addClass("expand-summary"):$("#proposal-summary-link span").removeClass("expand-summary").addClass("collapse-summary"),summaryContent.slideToggle(),e.preventDefault()}),$selectOtherTopics.click(function(e){e.preventDefault(),$topicHeaderMenu.toggle(),$dropdownWidth=500,$topicHeaderMenu.css("width",$dropdownWidth+"px"),$topicHeaderMenuDoc.css("width",$dropdownWidth+1+"px"),$topicHeaderMenu.is(":hidden")?($(this).removeClass("active"),$arrow.css("background-position","-29px -66px")):($arrow.css("background-position","-50px -66px"),$(this).addClass("active"))}),$selectOtherTopics.blur(function(){$topicHeaderMenu.is(":hover")||$topicHeaderMenu.is(":hidden")||$(this).click()})}}(SP.TopicHeader={},SP.jQuery);